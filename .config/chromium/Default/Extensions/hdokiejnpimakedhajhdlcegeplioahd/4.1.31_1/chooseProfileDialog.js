var ChooseProfileDialog=function(e){Dialog.call(this,e,{nextButtonText:Strings.translateString("Fill"),title:Strings.translateString("Choose Form Fill and Credit Card"),closeButtonEnabled:!0,maximizeButtonEnabled:!0})};ChooseProfileDialog.prototype=Object.create(Dialog.prototype);ChooseProfileDialog.prototype.constructor=ChooseProfileDialog;
(function(){ChooseProfileDialog.prototype.open=function(a){a.saveOptions=$.extend({source:"vault"},a.saveOptions);Dialog.prototype.open.call(this,$.extend(a,{defaultData:{alwaysChoose:bg.Preferences.get("alwayschooseprofilecc")}}))};ChooseProfileDialog.prototype.initialize=function(){Dialog.prototype.initialize.apply(this,arguments);this.profileElement=$("#profileContainer");this.creditElement=$("#creditCardContainer")};var e=function(a,b,d,c){b=LPTools.buildRadioButton(b,void 0,a.getName());b.children[0].setAttribute("ffid",
a.getID());if(0===d.children().length||a.getID()===c)b.children[0].checked=!0;d.append(b)};ChooseProfileDialog.prototype.setup=function(){Dialog.prototype.setup.apply(this,arguments);var a=LPProxy.getFormFillModels();this.profileElement.empty();this.creditElement.empty();for(var b=bg.Preferences.get(FormFill.prototype.FORM_FILL_TYPE_GENERIC+"ffid"),d=bg.Preferences.get(FormFill.prototype.FORM_FILL_TYPE_CREDIT_CARD+"ffid"),c=0,g=a.length;c<g;++c){var f=a[c];f.isCreditCard()?f._data.ccnum&&e(f,"selectedCreditCard",
this.creditElement,d):e(f,"selectedProfile",this.profileElement,b)}};ChooseProfileDialog.prototype.handleSubmit=function(a){var b={},d=this.profileElement.find(".radio:checked").attr("ffid");b[FormFill.prototype.FORM_FILL_TYPE_GENERIC+"ffid"]=d;var c=this.creditElement.find(".radio:checked").attr("ffid");b[FormFill.prototype.FORM_FILL_TYPE_CREDIT_CARD+"ffid"]=c;b.alwayschooseprofilecc=a.alwaysChoose;bg.Preferences.set(b);var e=this.data.saveOptions&&this.data.saveOptions.source?this.data.saveOptions.source:
"vault";this.data.tabID?(bg.fillform(d,!1,this.data.tabID,c,null,null,e),this.close()):bg.get_selected_tab_data(null,function(a){bg.fillform(d,!1,a.id,c,null,null,e);this.close()})}})();
