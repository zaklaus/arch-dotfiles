(function(c){c.initialize=function(){chrome.runtime.onConnect.addListener(function(a){if(0===a.name.indexOf("requestPort")){var b=c.initializeRequestFramework({sendContentScript:function(b){if(a.disconnected)return!1;a.postMessage(b);return!0},windowID:a.sender&&a.sender.tab?a.sender.tab.windowId:null,tabURL:a.sender&&a.sender.tab?a.sender.tab.url:null,tabID:a.sender&&a.sender.tab?a.sender.tab.id:null});a.onMessage.addListener(b.requestHandler);a.onDisconnect.addListener(function(){a.disconnected=
!0;b.disconnectHandler()})}})};c.openPopoverDialog=function(a){c.openTabDialog.apply(c,arguments)};c.refreshGroupNames=function(){};c.closePopovers=function(){chrome.extension.getViews({type:"popup"}).forEach(function(a){a.close()})};var g=null,h=function(a){if(a.url&&a.callback){var b="chrome://favicon/"+a.url,d=document.createElement("img");d.src=b;d.addEventListener("load",function(){var b;b="";try{var c=document.createElement("canvas");c.height=d.clientHeight;c.width=d.clientWidth;c.getContext("2d").drawImage(d,
0,0);b=c.toDataURL()}catch(e){}document.body.removeChild(d);a.callback(b===g?"":b)});d.addEventListener("error",function(){a.callback("");document.body.removeChild(d)});document.body.appendChild(d)}};h({url:"",callback:function(a){g=a}});c.getFavicon=h;var e=function(a,b){LPTabs.get({tabID:a.id,callback:function(c){if(b.inject){var e=0,g=[].concat(b.inject.files),h=function(){++e===g.length&&(c.extendTop({context:b.inject.context}),b.inject.allFrames&&c.extendFrames({context:b.inject.context}),b.loadHandler&&
b.loadHandler(c))};g.forEach(function(c){chrome.tabs.executeScript(a.id,{file:c,allFrames:b.inject.allFrames},h)})}else b.loadHandler&&b.loadHandler(c);if(b.closeHandler){var f;a:{var l=c.tabDetails,j=chrome.extension.getViews({type:"tab",windowId:l.windowID});if(1===j.length)f=j[0];else{for(var k=0,n=j.length;k<n;++k){var m=j[k];if(m.tabID===l.tabID){f=m;break a}}f=null}}f&&f.addEventListener("beforeunload",function(){b.closeHandler(f)})}}})};c.getCurrentTab=function(a){chrome.tabs.query({active:!0,
currentWindow:!0},function(b){1===b.length&&LPTabs.get({tabID:b[0].id,callback:a})})};c.openDialogWindow=function(a){var b=a.features||{};b.url=a.url;b.type=chrome.windows.CreateType.POPUP;chrome.windows.create(b,function(b){e(b.tabs[0],a)})};c.openTab=function(a){chrome.tabs.create({url:a.url,active:!a.inactive},function(b){e(b,a)})};c.openWindow=function(a){chrome.windows.create({url:a.url},function(b){e(b.tabs[0],a)})};c.openSame=function(a){chrome.tabs.update(null,{url:a.url},function(b){e(b,
a)})};c.navigateTab=function(a){chrome.tabs.update(a.tabId,{url:a.url,active:!0},function(b){e(b,a)})};c.activateTab=function(a){chrome.windows.update(a.windowID,{focused:!0});chrome.tabs.update(a.tabID,{active:!0})};c.closeTab=function(a){chrome.tabs.remove(a.tabID)};c.onTabUpdated=function(a){if("function"===typeof a){var b=function(b,c){"complete"===c.status&&LPTabs.get({tabID:c.tabId,callback:a})};chrome.tabs.onUpdated.addListener(b)}return function(){chrome.tabs.onUpdated.removeListener(b)}};
c.onTabActivated=function(a){if("function"===typeof a){var b=function(b){LPTabs.get({tabID:b.tabId,callback:a})};chrome.tabs.onActivated.addListener(b)}return function(){chrome.tabs.onActivated.removeListener(b)}};c.onTabClosed=function(a){if("function"===typeof a){var b=function(b){a(b)};chrome.tabs.onRemoved.addListener(b)}return function(){chrome.tabs.onRemoved.removeListener(b)}}})(LPPlatform);
