var lpResizeEvent=function(){function g(){c||(c=setTimeout(function(){c=null;e&&e()},66))}var c,e;return{attachWindowResizeEvent:function(c){e=c;window.addEventListener("resize",g)},detachWindowResizeEvent:function(){e=null;window.removeEventListener("resize",g)}}}();
LPInfieldFrame=function(){function g(a){if(h)h=!1;else{if(a.iframe&&!a.fieldEl)try{a.fieldEl=$(a.iframe).contents().find("#"+a.id)[0]}catch(f){}if(a&&!("focus"===a.eventType&&l)){if(b){if(d.id===a.id)return;e("away")}a.url=m;d=a;b=LPFrame.openFrame({url:m,interfaceDefinition:Interfaces.InfieldPopupInterface});n();j();lpResizeEvent.attachWindowResizeEvent(j);window.addEventListener("click",c,!0);bg.sendLpImprove("newinfieldopen",{source:"formv2",option:a.eventType})}}}function c(a){if(d&&a.target.id===
d.id)return!1;e("away");return!0}function e(a){b&&(a&&(h="action"==a,bg.sendLpImprove("newinfieldclose",{source:"formv2",option:a}),"close"===a&&(l=!0,d.fieldEl&&(LP_addEventHandler(d.fieldEl,"click",launchPopup,!1),realLaunchPopup&&d.fieldEl.removeEventListener("focus",realLaunchPopup)))),window.removeEventListener("click",c),lpResizeEvent.detachWindowResizeEvent(),b&&b.close(),d=b=null)}function p(a,f){var b={};a&&(b.height=a);f&&(b.width=f);return b}function q(a){var f={top:0,left:0};if(a){var d=
{top:0,left:0};a.iframe&&(d=a.iframe.getBoundingClientRect());var c={bottom:parseInt(a.posy),left:parseInt(a.posx),width:a.width};a.fieldEl&&a.fieldEl.getBoundingClientRect?c=a.fieldEl.getBoundingClientRect():a.fieldBox&&(c=a.fieldBox);f.top=window.pageYOffset+d.top+c.bottom;f.left=window.pageXOffset+d.left+c.left+c.width-375;var e=360;0>=f.left&&(f.left=window.pageXOffset+d.left+c.left-10,e=25)}a=e;b&&b.getInterface().lpInfield.setArrowPosition({position:a});return f}function n(){b&&b.css({display:"block",
position:"absolute",height:"0px"})}function j(){b&&b.css(q(d))}var b,m="contentScriptPopup.html",d,h,k,l=!1;return{close:e,show:n,openFrame:function(a){var b;if(!(b=k)){var c;b=function(){var a=this,b=arguments;clearTimeout(c);c=setTimeout(function(){c=null;g.apply(a,b)},100)}}k=b;k(a)},resizeFrame:function(a,c){b&&b.css(p(a,c))},positionFrame:j}}();function LP_keypress_handler(g){27==g.keyCode?LPInfieldFrame.close("close"):9==g.keyCode&&LPInfieldFrame.close("away")};
