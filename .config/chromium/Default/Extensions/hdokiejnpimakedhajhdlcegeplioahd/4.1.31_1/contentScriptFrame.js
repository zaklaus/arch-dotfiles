LPFrame=function(){var g=function(c,a){for(var b in a)c.style[b]=a[b];return c},m=function(c,a){var b=a.tracking,d=null,e=[],g=null,k=null,j=a.interfaceDefinition;this.close=function(){LPFrame.close(c);this.cleanup()};this.css=function(b){LPFrame.css({id:c,css:b})};this.cleanup=function(){window.removeEventListener("resize",this.refreshPosition);window.removeEventListener("scroll",this.refreshPosition)};var h=function(b,c,a){if(a){if("string"===typeof a)if(a.indexOf("%"))a=b[c]*parseInt(a.substring(0,
a.indexOf("%")))/100;else throw"trackElement only supports numbers or percentages for translations";return a}return 0};this.refreshPosition=function(){if(b){var a=b.element.getBoundingClientRect(),d=f[c].container,e=a.top,a=a.left;b.frameTranslation&&(e+=h(d,"clientHeight",b.frameTranslation.y),a+=h(d,"clientWidth",b.frameTranslation.x));b.targetTranslation&&(e+=h(b.element,"clientHeight",b.targetTranslation.y),a+=h(b.element,"clientWidth",b.targetTranslation.x));d.style.top=l(e);d.style.left=l(a)}};
this.trackElement=function(a){b=a;window.addEventListener("resize",this.refreshPosition);window.addEventListener("scroll",this.refreshPosition)};this.getInterface=function(){null===k&&(g=function(a){null===d?e.push(a):LPPlatform.requestFramework.sendRequest({type:"contentScriptRequest",data:a,frameID:d})},k=Interfaces.createInstance(j,{direct:!1,context:"contentScript",requestFunction:g}));return k};this.setFrameID=function(a){d=a;for(a=0;a<e.length;++a)g(e[a])};this.getDialogID=function(){return c};
b&&this.trackElement(b)},n=0,f={};Topics.get(Topics.CLEAR_DATA).subscribe(function(){for(var c in f)LPFrame.close(c)});var l=function(c){return"string"===typeof c?c:"number"===typeof c?c+"px":""},e=null,j=function(c){var a=++n,b=document.createElement("iframe"),d=getchromeurl(c.url),d=d+((-1<d.indexOf("?")?"&":"?")+"dialogID="+a);g_isfirefoxsdk?b.setAttribute("lpsrc",d):b.src=d;g(b,{border:"none",position:"relative",height:"100%",width:"100%"});b.setAttribute("scrolling","no");d=document.createElement("div");
g(d,{position:"fixed","z-index":"2147483647",display:"none",width:"100%",height:"100%"});d.appendChild(b);f[a]={container:d,frame:new m(a,c)};document.body.appendChild(d);return f[a].frame};return{css:function(c){if(c){var a=f[c.id];if(a){for(var b in c.css)a.container.style[b]=l(c.css[b]);a.frame.refreshPosition()}}"function"===typeof c.callback&&c.callback()},close:function(c){var a=f[c];a&&(a.container.remove(),a.frame.cleanup(),delete f[c])},openDialog:function(c,a,b){var d=j({url:"contentScriptDialog.html",
interfaceDefinition:Interfaces.ContentScriptDialogInterface});d.getInterface().LPDialog.openDialog(c,a);b&&(b.css&&d.css(b.css),b.callback&&b.callback(d.getDialogID()));return d},openFrame:j,initializeRequestFramework:function(c,a){var b=f[c];b&&b.frame.setFrameID(a)},showModal:function(){null===e&&(e=document.createElement("div"),g(e,{position:"fixed","z-index":"2147483646",top:"0px",right:"0px",bottom:"0px",left:"0px","background-color":"rgba(52, 61, 68, 0.6)"}));document.body.appendChild(e)},hideModal:function(){e&&
document.body.removeChild(e)}}}();
