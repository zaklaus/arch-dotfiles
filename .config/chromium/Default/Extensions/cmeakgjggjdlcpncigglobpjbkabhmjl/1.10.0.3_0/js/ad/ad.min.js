function getStat(){return JSON.parse(localStorage.getItem(statName))||{mto:{shows:0,clicks:0},to:{shows:0,clicks:0}}}function setStat(t){try{localStorage.setItem(statName,JSON.stringify(t))}catch(t){return!1}return!0}function saveStat(t,o){var s=getStat();return"mto"===t?"click"===o?s.mto.clicks+=1:"show"===o&&(!s.mto.displayed_at||s.mto.displayed_at+DELTA1MIN<Date.now())&&(s.mto.shows+=1,s.mto.displayed_at=Date.now()):"to"===t&&("click"===o?s.to.clicks+=1:(!s.to.displayed_at||s.to.displayed_at+DELTA1MIN<Date.now())&&(s.to.shows+=1,s.to.displayed_at=Date.now())),setStat(s)}function getToken(t,o){var s=new Date(o),e=0;for(var a in t)for(var c in t[a])e+=parseInt(t[a][c],10);return s.getFullYear()+s.getMonth()+s.getDate()+e}function sendStat(t){var o=getStat(),s=Date.now();(o.mto.shows||o.mto.clicks||o.to.shows||o.to.clicks)&&$.ajax({method:"POST",url:MAIN_COUNTER_URL+"?ver="+t,crossDomain:!0,headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest","Api-Token":getToken(o,s)},data:JSON.stringify({ver:t,ts:s,stat:o})}).done(function(t){var s=getStat();t.success&&(s.mto.shows=s.mto.shows-o.mto.shows>0?s.mto.shows-o.mto.shows:0,s.mto.clicks=s.mto.clicks-o.mto.clicks>0?s.mto.clicks-o.mto.clicks:0,s.to.shows=s.to.shows-o.to.shows>0?s.to.shows-o.to.shows:0,s.to.clicks=s.to.clicks-o.to.clicks>0?s.to.clicks-o.to.clicks:0,setStat(s))}).fail(function(t){console.error(t)})}function clearStat(){localStorage.removeItem(statName),saveStat({mto:{shows:0,clicks:0},to:{shows:0,clicks:0}})}function checkStat(){const t=getStat();return!!{}.hasOwnProperty.call(t,"mto")}const statName="AdStat";